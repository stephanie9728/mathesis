meta:
  study_name: "mini-cereal-milk"
  explanation_timing: "immediate"     # "none" | "immediate" | "delayed"
  llm_model: "gpt-4o-mini"

paths:
  video_root: "./camera_demo_mini"    # 改成你的视频目录路径

objects:
  - bowl
  - cup
  - milk
  - cereal_box
  - spoon
  - table

task:
  id: "T1-cereal-milk"
  name: "准备麦片加牛奶"
  goal: "在桌面碗里准备好麦片加牛奶，并用勺子搅拌，杯子放在旁边。"
  steps:
    - "把碗放到桌子上"
    - "拿起麦片盒"
    - "把麦片倒进碗（不是杯子）"
    - "把麦片盒放回桌子"
    - "拿起牛奶"
    - "把牛奶倒进碗里"
    - "用勺子搅拌碗里的食物"
    - "把勺子放回桌子"
    - "确保杯子放在碗旁边"

checks:
  require:
    - {type: node, label: bowl, ge: 1, message: "应检测到碗"}
    - {type: node, label: cup, ge: 1, message: "应检测到杯子"}
    - {type: node, label: cereal_box, ge: 1, message: "应检测到麦片盒"}
    - {type: node, label: milk, ge: 1, message: "应检测到牛奶"}
    - {type: node, label: spoon, ge: 1, message: "应检测到勺子"}
  forbid:
    - {type: edge, s: cereal_box, r: near, o: cup, min_count: 3, message: "不应将麦片倒进杯子（目标是碗）"}

failures:
  # 错误注入 1：麦片倒错容器（杯子而非碗）
  - id: F1-mispour-cereal-to-cup
    when: immediate
    condition: {type: edge, s: cereal_box, r: near, o: cup, min_count: 3}
    explain: "检测到你正在把麦片倒进杯子，而不是碗。麦片应倒入碗中以便加牛奶。"
    correction_plan:
      - "停止向杯子中倒麦片。"
      - "把麦片盒移到碗上方，对准碗中心。"
      - "将麦片缓慢倒入碗中。"
      - "放下麦片盒到桌上。"

  # 错误注入 2：牛奶倒错容器（倒进杯子或错误区域）
  - id: F2-mispour-milk-to-cup
    when: immediate
    condition: {type: edge, s: milk, r: near, o: cup, min_count: 3}
    explain: "检测到牛奶正在被倒入杯子，而不是碗。请确保牛奶倒入碗中的麦片上。"
    correction_plan:
      - "将牛奶移到碗的上方中央位置。"
      - "缓慢倒入牛奶，直到碗中麦片被浸湿。"
      - "放下牛奶到桌上。"

  # 错误注入 3：搅拌错误（未对准碗）
  - id: F3-spoon-wrong-target
    when: delayed
    condition: {type: edge, s: spoon, r: near, o: cup, min_count: 3}
    explain: "检测到你正在用勺子靠近杯子，而不是碗。搅拌应在碗中完成。"
    correction_plan:
      - "将勺子移动到碗的中心区域。"
      - "在碗内以顺时针方向轻轻搅拌。"

  # 最终布局检查（杯子应在碗旁边右侧）
  - id: F4-placement-cup-wrong-side
    when: delayed
    condition: {type: edge, s: cup, r: left_of, o: bowl, min_count: 2}
    explain: "杯子最终位于碗的左侧，应放在碗的右侧以便饮用。"
    correction_plan:
      - "将杯子移动到碗的右侧，保持大约一个杯子宽度的距离。"
